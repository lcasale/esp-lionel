substitutions:
  friendly_name: "ESP Lionel"

esphome:
  name: esp-lionel-node
  friendly_name: ${friendly_name}

esp32:
  board: esp32dev
  framework:
    type: esp-idf
    version: recommended

# Import the TMCC external component from GitHub
external_components:
  - source:
      type: git
      url: https://github.com/lcasale/esp-lionel
      ref: main
    components: [tmcc]

logger:
  level: DEBUG

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  min_auth_mode: "WPA2"
  ap:
    ssid: "${friendly_name} Fallback"
    password: !secret ap_password

api:
  encryption:
    key: !secret api_encryption_key

web_server:
  port: 80
  auth:
    username: !secret web_server_username
    password: !secret web_server_password

ota:
  - platform: esphome
    password: !secret ota_password

# UART used to talk to the TMCC base (TMCC1 uses 9600 8N1)
uart:
  - id: tmcc_uart
    tx_pin: GPIO23
    rx_pin: GPIO22
    baud_rate: 9600
    parity: NONE
    stop_bits: 1

# TMCC Controller configuration
tmcc:
  uart_id: tmcc_uart
  engine:
    address: 1
    max_speed: 18
    speed:
      name: "${friendly_name} Speed"
    direction:
      name: "${friendly_name} Direction"
    horn:
      name: "${friendly_name} Horn"
    bell:
      name: "${friendly_name} Bell"
    front_coupler:
      name: "${friendly_name} Front Coupler"
    rear_coupler:
      name: "${friendly_name} Rear Coupler"
    boost:
      name: "${friendly_name} Boost"
    brake:
      name: "${friendly_name} Brake"
